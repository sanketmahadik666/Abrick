(()=>{var e,t,n,i={756(e,t,n){var i=n(633)();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},851(e,t,n){"use strict";n.d(t,{Ay:()=>h});var i=n(506),r=n(467),a=n(284),o=n(29),s=n(901),c=n(277);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var d=function(){return(0,s.A)(function e(){(0,o.A)(this,e),this.state={loading:{global:!1,toilets:!1,reviews:!1,auth:!1},ui:{activeModal:null,notifications:[],sidebarOpen:!1,theme:"light"},user:{isAuthenticated:!1,data:null,token:null},data:{toilets:[],reviews:[],stats:null},settings:{mapFilters:{showPublic:!0,showPrivate:!0},qrScanner:{active:!1,lastScan:null}}},this.observers=new Map,this.history=[],this.maxHistorySize=10,this.subscribe=this.subscribe.bind(this),this.unsubscribe=this.unsubscribe.bind(this),this.notify=this.notify.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.resetState=this.resetState.bind(this)},[{key:"subscribe",value:function(e,t){var n=this;return this.observers.has(e)||this.observers.set(e,new Set),this.observers.get(e).add(t),function(){return n.unsubscribe(e,t)}}},{key:"unsubscribe",value:function(e,t){this.observers.has(e)&&this.observers.get(e).delete(t)}},{key:"notify",value:function(e,t){var n=this;this.observers.has(e)&&this.observers.get(e).forEach(function(i){try{i(e,t,n.getState())}catch(e){}})}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}},{key:"setState",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getState();if("function"==typeof e)t=e(i);else{if("object"!==(0,a.A)(e))return;t=this.deepMerge(i,e)}this.validateState(t)&&(this.state=t,this.addToHistory(i,t,n),!0!==n.silent&&this.notify("state:changed",{prevState:i,newState:t,changes:this.getStateChanges(i,t)}))}},{key:"deepMerge",value:function(e,t){var n=this,i=l({},e);return Object.keys(t).forEach(function(r){t[r]&&"object"===(0,a.A)(t[r])&&!Array.isArray(t[r])?i[r]=n.deepMerge(e[r]||{},t[r]):i[r]=t[r]}),i}},{key:"validateState",value:function(e){return["loading","ui","user","data","settings"].every(function(t){return t in e})}},{key:"getStateChanges",value:function(e,t){var n={},i=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object.keys(t).forEach(function(o){var s=r?"".concat(r,".").concat(o):o;o in e?e[o]!==t[o]&&("object"===(0,a.A)(e[o])&&"object"===(0,a.A)(t[o])?i(e[o],t[o],s):n[s]={from:e[o],to:t[o]}):n[s]={from:void 0,to:t[o]}})};return i(e,t),n}},{key:"addToHistory",value:function(e,t,n){this.history.push({timestamp:new Date,prevState:e,newState:t,description:n.description||"State change",changes:this.getStateChanges(e,t)}),this.history.length>this.maxHistorySize&&this.history.shift()}},{key:"resetState",value:function(){this.setState({loading:{global:!1,toilets:!1,reviews:!1,auth:!1},ui:{activeModal:null,notifications:[],sidebarOpen:!1,theme:"light"},user:{isAuthenticated:!1,data:null,token:null},data:{toilets:[],reviews:[],stats:null},settings:{mapFilters:{showPublic:!0,showPrivate:!0},qrScanner:{active:!1,lastScan:null}}},{description:"State reset"})}},{key:"getHistory",value:function(){return(0,i.A)(this.history)}},{key:"setLoading",value:function(e,t){this.setState(function(n){return l(l({},n),{},{loading:l(l({},n.loading),{},(0,r.A)({},e,t))})},{description:"Loading ".concat(e,": ").concat(t)})}},{key:"setUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setState(function(i){return l(l({},i),{},{user:{isAuthenticated:e,data:t,token:n}})},{description:"User authentication: ".concat(e)})}},{key:"addNotification",value:function(e){var t=this,n=Date.now().toString(),r=l(l({},e),{},{id:n});return this.setState(function(e){return l(l({},e),{},{ui:l(l({},e.ui),{},{notifications:[].concat((0,i.A)(e.ui.notifications),[r])})})},{description:"Notification added"}),0!==e.duration&&setTimeout(function(){t.removeNotification(n)},e.duration||c.A.ui.toastDuration),n}},{key:"removeNotification",value:function(e){this.setState(function(t){return l(l({},t),{},{ui:l(l({},t.ui),{},{notifications:t.ui.notifications.filter(function(t){return t.id!==e})})})},{description:"Notification removed"})}},{key:"setToilets",value:function(e){this.setState(function(t){return l(l({},t),{},{data:l(l({},t.data),{},{toilets:e||[]})})},{description:"Toilets updated"})}},{key:"setReviews",value:function(e){this.setState(function(t){return l(l({},t),{},{data:l(l({},t.data),{},{reviews:e||[]})})},{description:"Reviews updated"})}}])}();const h=new d},876(e,t,n){"use strict";var i=n(284),r=n(467),a=n(848),o=n(29),s=n(901),c=n(756),u=n(277),l=n(851),d=n(662),h=n(134);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var p=function(){return(0,s.A)(function e(){(0,o.A)(this,e),this.modules=new Map,this.initialized=!1,this.currentPage=null,this.init=this.init.bind(this),this.destroy=this.destroy.bind(this),this.navigateTo=this.navigateTo.bind(this),this.handleGlobalError=this.handleGlobalError.bind(this),this.handleUnhandledRejection=this.handleUnhandledRejection.bind(this)},[{key:"init",value:(g=(0,a.A)(c.mark(function e(){var t;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setupGlobalErrorHandlers(),e.next=1,this.initializeCoreSystems();case 1:return e.next=2,this.initializePageModules();case 2:this.setupGlobalEventListeners(),this.initialized=!0,window.dispatchEvent(new CustomEvent("app:ready",{detail:{app:this,config:u.A}})),e.next=4;break;case 3:e.prev=3,t=e.catch(0),this.handleInitializationError(t);case 4:case"end":return e.stop()}},e,this,[[0,3]])})),function(){return g.apply(this,arguments)})},{key:"setupGlobalErrorHandlers",value:function(){var e=this;window.addEventListener("unhandledrejection",this.handleUnhandledRejection),window.addEventListener("error",this.handleGlobalError),l.Ay.subscribe("app:error",function(t,n){e.showErrorNotification(n.message||"An application error occurred")})}},{key:"handleUnhandledRejection",value:function(e){e.preventDefault(),l.Ay.addNotification({type:"error",title:"Application Error",message:"An unexpected error occurred. Please refresh the page.",duration:0})}},{key:"handleGlobalError",value:function(e){e.filename&&e.filename.includes(".js")||l.Ay.addNotification({type:"error",title:"Application Error",message:"Something went wrong. Please try again.",duration:5e3})}},{key:"initializeCoreSystems",value:(p=(0,a.A)(c.mark(function e(){return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.initializeApiService(),this.initializeStateManagement(),this.initializePerformanceMonitoring();case 1:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})},{key:"initializeApiService",value:function(){d.V.addRequestInterceptor(function(){var e=(0,a.A)(c.mark(function e(t){var n;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=l.Ay.getState().user.token)&&(t.headers=v(v({},t.headers),{},{Authorization:"Bearer ".concat(n)})),e.abrupt("return",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),d.V.addResponseInterceptor(function(){var e=(0,a.A)(c.mark(function e(t,n){return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"object"!==(0,i.A)(t)){e.next=2;break}if(!1!==t.success||!t.message){e.next=1;break}throw new Error(t.message);case 1:if(!t.success||!t.data){e.next=2;break}return e.abrupt("return",t.data);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),d.V.addRequestInterceptor(function(){var e=(0,a.A)(c.mark(function e(t){return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.Ay.setLoading("api",!0),e.abrupt("return",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),d.V.addResponseInterceptor(function(){var e=(0,a.A)(c.mark(function e(t,n){return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.Ay.setLoading("api",!1),e.abrupt("return",t);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}())}},{key:"initializeStateManagement",value:function(){var e=this;l.Ay.subscribe("state:changed",function(t,n){e.handleStateChange(n)});var t=localStorage.getItem("adminToken")||localStorage.getItem("token");if(t)try{3===t.split(".").length&&l.Ay.setUser(!0,null,t)}catch(e){localStorage.removeItem("adminToken"),localStorage.removeItem("token")}}},{key:"handleStateChange",value:function(e){e.changes["user.isAuthenticated"]&&this.handleAuthenticationChange(e.changes["user.isAuthenticated"].to),e.changes["loading.global"]&&this.handleLoadingChange(e.changes["loading.global"].to)}},{key:"handleAuthenticationChange",value:function(e){e?this.updateAuthenticatedUI(!0):this.updateAuthenticatedUI(!1)}},{key:"handleLoadingChange",value:function(e){var t=(0,h.$)("#globalLoading");t&&(e?t.classList.remove("hidden"):t.classList.add("hidden"))}},{key:"updateAuthenticatedUI",value:function(e){var t=document.querySelectorAll(".admin-link"),n=document.querySelectorAll(".logout-btn");t.forEach(function(t){t.style.display=e?"inline":"none"}),n.forEach(function(t){t.style.display=e?"inline":"none"})}},{key:"initializePerformanceMonitoring",value:function(){window.performance&&window.performance.timing&&window.addEventListener("load",function(){var e=window.performance.timing,t=e.loadEventEnd-e.navigationStart;u.A.features.enableAnalytics&&l.Ay.notify("performance:pageLoad",{loadTime:t})}),window.performance&&window.performance.memory&&setInterval(function(){window.performance.memory},3e4)}},{key:"initializePageModules",value:(f=(0,a.A)(c.mark(function e(){var t;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("/"!==(t=window.location.pathname)&&"/index.html"!==t){e.next=2;break}return e.next=1,this.initializeHomePage();case 1:case 3:e.next=5;break;case 2:if("/admin.html"!==t){e.next=4;break}return e.next=3,this.initializeAdminPage();case 4:if("/review.html"!==t){e.next=5;break}return e.next=5,this.initializeReviewPage();case 5:case 6:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"initializeHomePage",value:(r=(0,a.A)(c.mark(function e(){var t,i,r;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPage="home",e.prev=1,e.next=2,Promise.all([n.e(179),n.e(866),n.e(230)]).then(n.bind(n,230));case 2:return t=e.sent,i=t.HomePage,r=new i,e.next=3,r.init();case 3:this.modules.set("homePage",r),e.next=5;break;case 4:e.prev=4,e.catch(1);case 5:case"end":return e.stop()}},e,this,[[1,4]])})),function(){return r.apply(this,arguments)})},{key:"initializeAdminPage",value:(t=(0,a.A)(c.mark(function e(){var t,i,r;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPage="admin",e.prev=1,e.next=2,Promise.all([n.e(671),n.e(866),n.e(419)]).then(n.bind(n,680));case 2:return t=e.sent,i=t.AdminPage,r=new i,e.next=3,r.init();case 3:this.modules.set("adminPage",r),e.next=5;break;case 4:e.prev=4,e.catch(1);case 5:case"end":return e.stop()}},e,this,[[1,4]])})),function(){return t.apply(this,arguments)})},{key:"initializeReviewPage",value:(e=(0,a.A)(c.mark(function e(){var t,i,r;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPage="review",e.prev=1,e.next=2,Promise.all([n.e(671),n.e(866),n.e(81)]).then(n.bind(n,376));case 2:return t=e.sent,i=t.ReviewPage,r=new i,e.next=3,r.init();case 3:this.modules.set("reviewPage",r),e.next=5;break;case 4:e.prev=4,e.catch(1);case 5:case"end":return e.stop()}},e,this,[[1,4]])})),function(){return e.apply(this,arguments)})},{key:"setupGlobalEventListeners",value:function(){var e=this;document.addEventListener("click",function(t){if(t.target.matches("[data-navigate]")){t.preventDefault();var n=t.target.getAttribute("data-navigate");e.navigateTo(n)}}),document.addEventListener("submit",function(e){}),document.addEventListener("keydown",function(e){"Escape"===e.key&&l.Ay.setState(function(e){return v(v({},e),{},{ui:v(v({},e.ui),{},{activeModal:null})})})}),window.addEventListener("online",function(){l.Ay.addNotification({type:"success",title:"Connection Restored",message:"You are back online",duration:3e3})}),window.addEventListener("offline",function(){l.Ay.addNotification({type:"warning",title:"Connection Lost",message:"You are currently offline",duration:0})})}},{key:"navigateTo",value:function(e){e.startsWith("http")?window.location.href=e:"home"===e?window.location.href="/":"admin"===e?window.location.href="/admin.html":"review"===e?window.location.href="/review.html":this.handleInPageNavigation(e)}},{key:"handleInPageNavigation",value:function(e){if(e.startsWith("#")){var t=(0,h.$)(e);t&&t.scrollIntoView({behavior:"smooth"})}}},{key:"showErrorNotification",value:function(e){l.Ay.addNotification({type:"error",title:"Error",message:e,duration:5e3})}},{key:"handleInitializationError",value:function(e){var t=(0,h.$)("#globalLoading");t&&(t.innerHTML='\n                <div class="global-loading-spinner"></div>\n                <div class="global-loading-text">\n                    Failed to initialize application.<br>\n                    <small>'.concat(e.message,'</small><br><br>\n                    <button onclick="window.location.reload()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">\n                        Reload Page\n                    </button>\n                </div>\n            '))}},{key:"destroy",value:function(){window.removeEventListener("unhandledrejection",this.handleUnhandledRejection),window.removeEventListener("error",this.handleGlobalError),this.modules.forEach(function(e,t){if("function"==typeof e.destroy)try{e.destroy()}catch(e){}}),this.modules.clear(),l.Ay.resetState(),this.initialized=!1}},{key:"getInfo",value:function(){return{name:u.A.name,version:u.A.version,initialized:this.initialized,currentPage:this.currentPage,modules:Array.from(this.modules.keys()),environment:u.A.environment}}}]);var e,t,r,f,p,g}(),g=new p;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){g.init().catch(function(e){})}):g.init().catch(function(e){})}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,a),n.exports}a.m=i,e=[],a.O=(t,n,i,r)=>{if(!n){var o=1/0;for(l=0;l<e.length;l++){for(var[n,i,r]=e[l],s=!0,c=0;c<n.length;c++)(!1&r||o>=r)&&Object.keys(a.O).every(e=>a.O[e](n[c]))?n.splice(c--,1):(s=!1,r<o&&(o=r));if(s){e.splice(l--,1);var u=i();void 0!==u&&(t=u)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[n,i,r]},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,n)=>(a.f[n](e,t),t),[])),a.u=e=>179===e?"js/components.0d4897d493147f9513c7.js":866===e?"js/866.a41ace9679903a354d93.js":"js/chunks/"+e+"."+{81:"8736585cead2af017612",230:"fe94f754d48c12157212",419:"6d3c0a48ed49125b082b"}[e]+".js",a.miniCssF=e=>{},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="toilet-review-system-frontend:",a.l=(e,i,r,o)=>{if(t[e])t[e].push(i);else{var s,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==n+r){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",n+r),s.src=e),t[e]=[i];var h=(n,i)=>{s.onerror=s.onload=null,clearTimeout(f);var r=t[e];if(delete t[e],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(e=>e(i)),n)return n(i)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="/",(()=>{var e={524:0};a.f.j=(t,n)=>{var i=a.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((n,r)=>i=e[t]=[n,r]);n.push(i[2]=r);var o=a.p+a.u(t),s=new Error;a.l(o,n=>{if(a.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,i[1](s)}},"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[o,s,c]=n,u=0;if(o.some(t=>0!==e[t])){for(i in s)a.o(s,i)&&(a.m[i]=s[i]);if(c)var l=c(a)}for(t&&t(n);u<o.length;u++)r=o[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(l)},n=self.webpackChunktoilet_review_system_frontend=self.webpackChunktoilet_review_system_frontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=a.O(void 0,[671,263],()=>a(876));o=a.O(o)})();
//# sourceMappingURL=app.2b1c67e5b93c0f89c098.js.map