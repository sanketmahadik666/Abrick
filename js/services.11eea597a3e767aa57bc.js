"use strict";(self.webpackChunktoilet_review_system_frontend=self.webpackChunktoilet_review_system_frontend||[]).push([[671],{105(e,t,r){r.d(t,{E:()=>l});var n=r(848),a=r(29),i=r(901),s=r(756),o=r(662),c=r(718),u=function(){return(0,i.A)(function e(){(0,a.A)(this,e),this.baseService=o.V},[{key:"login",value:(f=(0,n.A)(s.mark(function e(t){var r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.post(c.Sn.AUTH.LOGIN,{email:t.email,password:t.password});case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"register",value:(p=(0,n.A)(s.mark(function e(t){var r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.post(c.Sn.AUTH.REGISTER,{email:t.email,password:t.password,role:t.role||"user"});case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"getCurrentUser",value:(l=(0,n.A)(s.mark(function e(){var t;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.get(c.Sn.AUTH.ME);case 1:return t=e.sent,e.abrupt("return",t);case 2:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"logout",value:(u=(0,n.A)(s.mark(function e(){return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("adminToken"),localStorage.removeItem("token"),e.prev=1,e.next=2,this.baseService.post(c.Sn.AUTH.LOGOUT,{});case 2:e.next=4;break;case 3:e.prev=3,e.catch(1);case 4:return e.abrupt("return",{success:!0});case 5:case"end":return e.stop()}},e,this,[[1,3]])})),function(){return u.apply(this,arguments)})},{key:"refreshToken",value:(r=(0,n.A)(s.mark(function e(){var t;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("adminToken")||localStorage.getItem("token")){e.next=1;break}throw new Error("No token available to refresh");case 1:if(3!==t.split(".").length){e.next=2;break}return e.abrupt("return",{token:t,valid:!0});case 2:throw new Error("Invalid token format");case 3:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)})},{key:"validateToken",value:(t=(0,n.A)(s.mark(function e(t){var r,n;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return",{valid:!1,reason:"No token provided"});case 1:if(e.prev=1,3===(r=t.split(".")).length){e.next=2;break}return e.abrupt("return",{valid:!1,reason:"Invalid token format"});case 2:if(JSON.parse(atob(r[0])),!((n=JSON.parse(atob(r[1]))).exp&&Date.now()>=1e3*n.exp)){e.next=3;break}return e.abrupt("return",{valid:!1,reason:"Token expired"});case 3:return e.abrupt("return",{valid:!0,payload:n,expiresAt:n.exp?new Date(1e3*n.exp):null});case 4:return e.prev=4,e.catch(1),e.abrupt("return",{valid:!1,reason:"Token parsing failed"});case 5:case"end":return e.stop()}},e,null,[[1,4]])})),function(e){return t.apply(this,arguments)})},{key:"hasPermission",value:function(e,t){var r={user:1,admin:2,superadmin:3};return(r[t]||0)>=(r[e]||0)}},{key:"getToken",value:function(){return localStorage.getItem("adminToken")||localStorage.getItem("token")}},{key:"setToken",value:function(e){localStorage.setItem("adminToken",e),localStorage.setItem("token",e)}},{key:"clearToken",value:function(){localStorage.removeItem("adminToken"),localStorage.removeItem("token")}},{key:"isAuthenticated",value:(e=(0,n.A)(s.mark(function e(){var t,r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getToken()){e.next=1;break}return e.abrupt("return",!1);case 1:return e.prev=1,e.next=2,this.validateToken(t);case 2:return r=e.sent,e.abrupt("return",r.valid);case 3:return e.prev=3,e.catch(1),e.abrupt("return",!1);case 4:case"end":return e.stop()}},e,this,[[1,3]])})),function(){return e.apply(this,arguments)})},{key:"getUserRole",value:function(){var e=this.getToken();if(!e)return null;try{var t=e.split(".");if(3===t.length)return JSON.parse(atob(t[1])).role||"user"}catch(e){}return null}}]);var e,t,r,u,l,p,f}(),l=new u},438(e,t,r){r.d(t,{Z:()=>l});var n=r(848),a=r(29),i=r(901),s=r(756),o=r(662),c=r(718),u=function(){return(0,i.A)(function e(){(0,a.A)(this,e),this.baseService=o.V},[{key:"getMapData",value:(d=(0,n.A)(s.mark(function e(){var t,r,n,a,i,o=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=new URLSearchParams,void 0!==t.showPublic&&r.append("showPublic",t.showPublic),void 0!==t.showPrivate&&r.append("showPrivate",t.showPrivate),t.bounds&&(n="".concat(t.bounds.south,",").concat(t.bounds.west,",").concat(t.bounds.north,",").concat(t.bounds.east),r.append("bounds",n)),t.limit&&r.append("limit",t.limit),t.offset&&r.append("offset",t.offset),a="".concat(c.Sn.TOILETS.MAP,"?").concat(r),e.next=1,this.baseService.get(a);case 1:return i=e.sent,e.abrupt("return",i);case 2:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})},{key:"getStatistics",value:(v=(0,n.A)(s.mark(function e(){var t;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.get(c.Sn.TOILETS.STATS);case 1:return t=e.sent,e.abrupt("return",t);case 2:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)})},{key:"getToiletById",value:(h=(0,n.A)(s.mark(function e(t){var r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.get(c.Sn.TOILETS.BY_ID(t));case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"addPrivateToilet",value:(f=(0,n.A)(s.mark(function e(t){var r,n;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateToiletData(t),e.next=1,this.baseService.post(c.Sn.TOILETS.ADD_PRIVATE,{name:t.name,location:t.location,coordinates:t.coordinates,facilities:t.facilities||[],description:(null===(r=t.description)||void 0===r?void 0:r.trim())||""});case 1:return n=e.sent,e.abrupt("return",n);case 2:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"syncPublicData",value:(p=(0,n.A)(s.mark(function e(){var t,r,n,a=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={bounds:(t=a.length>0&&void 0!==a[0]?a[0]:{}).bounds,sources:t.sources||["osm","government"],city:t.city||"mumbai"},e.next=1,this.baseService.post(c.Sn.TOILETS.SYNC_PUBLIC,r);case 1:return n=e.sent,e.abrupt("return",n);case 2:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})},{key:"generateQRCode",value:(l=(0,n.A)(s.mark(function e(t){var r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.get(c.Sn.TOILETS.QR_CODE(t));case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"updateToilet",value:(u=(0,n.A)(s.mark(function e(t,r){var n;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.put(c.Sn.TOILETS.BY_ID(t),r);case 1:return n=e.sent,e.abrupt("return",n);case 2:case"end":return e.stop()}},e,this)})),function(e,t){return u.apply(this,arguments)})},{key:"deleteToilet",value:(r=(0,n.A)(s.mark(function e(t){var r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.delete(c.Sn.TOILETS.BY_ID(t));case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"searchToilets",value:(t=(0,n.A)(s.mark(function e(t){var r,n,a,i,o=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},(n=new URLSearchParams).append("q",t),r.limit&&n.append("limit",r.limit),r.type&&n.append("type",r.type),a="".concat(c.Sn.TOILETS.MAP,"/search?").concat(n),e.next=1,this.baseService.get(a);case 1:return i=e.sent,e.abrupt("return",i);case 2:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getNearbyToilets",value:(e=(0,n.A)(s.mark(function e(t){var r,n,a,i,o,u=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:1e3,n=u.length>2&&void 0!==u[2]?u[2]:{},(a=new URLSearchParams).append("lat",t.lat),a.append("lng",t.lng),a.append("radius",r),n.limit&&a.append("limit",n.limit),n.type&&a.append("type",n.type),i="".concat(c.Sn.TOILETS.MAP,"/nearby?").concat(a),e.next=1,this.baseService.get(i);case 1:return o=e.sent,e.abrupt("return",o);case 2:case"end":return e.stop()}},e,this)})),function(t){return e.apply(this,arguments)})},{key:"validateToiletData",value:function(e){if(!e)throw new Error("Toilet data is required");if(!e.name||"string"!=typeof e.name)throw new Error("Valid toilet name is required");if(!e.location||"string"!=typeof e.location)throw new Error("Valid location is required");if(!e.coordinates||"number"!=typeof e.coordinates.lat||"number"!=typeof e.coordinates.lng)throw new Error("Valid coordinates are required");if(e.coordinates.lat<-90||e.coordinates.lat>90)throw new Error("Latitude must be between -90 and 90");if(e.coordinates.lng<-180||e.coordinates.lng>180)throw new Error("Longitude must be between -180 and 180");if(e.facilities&&!Array.isArray(e.facilities))throw new Error("Facilities must be an array");if(e.description&&"string"!=typeof e.description)throw new Error("Description must be a string")}},{key:"calculateDistance",value:function(e,t){var r=e.lat*Math.PI/180,n=t.lat*Math.PI/180,a=(t.lat-e.lat)*Math.PI/180,i=(t.lng-e.lng)*Math.PI/180,s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(r)*Math.cos(n)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}},{key:"formatToiletData",value:function(e){return{id:e.id||e._id,name:e.name||"Unknown Toilet",location:e.location||"Location not specified",coordinates:e.coordinates,facilities:e.facilities||[],type:e.type||"private",averageRating:e.averageRating||0,totalReviews:e.totalReviews||0,verified:e.verified||!1,source:e.source||"manual",description:e.description||"",lastSynced:e.lastSynced,createdAt:e.createdAt,updatedAt:e.updatedAt}}},{key:"getTypeDisplayName",value:function(e){return{public:"Public Facility",private:"Private Toilet"}[e]||"Unknown Type"}},{key:"getFacilityDisplayName",value:function(e){return{handicap:"Handicap Accessible",baby_change:"Baby Change Station",shower:"Shower",bidet:"Bidet",paper_towel:"Paper Towels",hand_dryer:"Hand Dryer",unisex:"Unisex",fee_required:"Fee Required"}[e]||e.replace("_"," ").replace(/\b\w/g,function(e){return e.toUpperCase()})}}]);var e,t,r,u,l,p,f,h,v,d}(),l=new u},567(e,t,r){r.d(t,{W:()=>h});var n=r(467),a=r(848),i=r(29),s=r(901),o=r(756),c=r(662),u=r(718);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,n.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var f=function(){return(0,s.A)(function e(){(0,i.A)(this,e),this.baseService=c.V},[{key:"submitReview",value:(v=(0,a.A)(o.mark(function e(t){var r,n;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateReviewData(t),e.next=1,this.baseService.post(u.Sn.REVIEWS.SUBMIT,{toiletId:t.toiletId,rating:t.rating,cleanliness:t.cleanliness,maintenance:t.maintenance,accessibility:t.accessibility,comment:(null===(r=t.comment)||void 0===r?void 0:r.trim())||""});case 1:return n=e.sent,e.abrupt("return",n);case 2:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"getReviewsForToilet",value:(h=(0,a.A)(o.mark(function e(t){var r,n,a,i,s=arguments;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=new URLSearchParams,r.limit&&n.append("limit",r.limit),r.offset&&n.append("offset",r.offset),r.sort&&n.append("sort",r.sort),a="".concat(u.Sn.REVIEWS.BY_TOILET(t),"?").concat(n),e.next=1,this.baseService.get(a);case 1:return i=e.sent,e.abrupt("return",i);case 2:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"getAllReviews",value:(f=(0,a.A)(o.mark(function e(){var t,r,n,a,i=arguments;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},r=new URLSearchParams,t.limit&&r.append("limit",t.limit),t.offset&&r.append("offset",t.offset),t.sort&&r.append("sort",t.sort),t.toiletId&&r.append("toiletId",t.toiletId),n="".concat(u.Sn.REVIEWS.ALL,"?").concat(r),e.next=1,this.baseService.get(n);case 1:return a=e.sent,e.abrupt("return",a);case 2:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"getReviewById",value:(l=(0,a.A)(o.mark(function e(t){var r;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.get(u.Sn.REVIEWS.BY_ID(t));case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"updateReview",value:(n=(0,a.A)(o.mark(function e(t,r){var n,a;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r.rating||r.cleanliness||r.maintenance||r.accessibility)&&this.validateRatingData(r),e.next=1,this.baseService.put(u.Sn.REVIEWS.BY_ID(t),p(p({},r),{},{comment:null===(n=r.comment)||void 0===n?void 0:n.trim()}));case 1:return a=e.sent,e.abrupt("return",a);case 2:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"deleteReview",value:(r=(0,a.A)(o.mark(function e(t){var r;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.baseService.delete(u.Sn.REVIEWS.BY_ID(t));case 1:return r=e.sent,e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"getReviewStats",value:(t=(0,a.A)(o.mark(function e(){var t,r,n,a=arguments;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat((t=a.length>0&&void 0!==a[0]?a[0]:null)?u.Sn.REVIEWS.BY_TOILET(t):u.Sn.REVIEWS.ALL,"/stats"),e.next=1,this.baseService.get(r);case 1:return n=e.sent,e.abrupt("return",n);case 2:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"validateReviewData",value:function(e){if(!e)throw new Error("Review data is required");if(!e.toiletId||"string"!=typeof e.toiletId)throw new Error("Valid toilet ID is required");if(this.validateRatingData(e),e.comment&&"string"!=typeof e.comment)throw new Error("Comment must be a string");if(e.comment&&e.comment.length>500)throw new Error("Comment must be 500 characters or less")}},{key:"validateRatingData",value:function(e){["rating","cleanliness","maintenance","accessibility"].forEach(function(t){if(void 0!==e[t]){var r=e[t];if("number"!=typeof r||r<1||r>5)throw new Error("".concat(t," must be a number between 1 and 5"))}})}},{key:"calculateAverageRatings",value:function(e){if(!e||0===e.length)return{overall:0,cleanliness:0,maintenance:0,accessibility:0,totalReviews:0};var t=e.reduce(function(e,t){return e.rating+=t.rating||0,e.cleanliness+=t.cleanliness||0,e.maintenance+=t.maintenance||0,e.accessibility+=t.accessibility||0,e},{rating:0,cleanliness:0,maintenance:0,accessibility:0}),r=e.length;return{overall:Math.round(t.rating/r*10)/10,cleanliness:Math.round(t.cleanliness/r*10)/10,maintenance:Math.round(t.maintenance/r*10)/10,accessibility:Math.round(t.accessibility/r*10)/10,totalReviews:r}}},{key:"getReviewSummary",value:(e=(0,a.A)(o.mark(function e(t){var r,n;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=2,this.getReviewsForToilet(t,{limit:1e3});case 2:return r=e.sent,n=this.calculateAverageRatings(r),e.abrupt("return",n);case 3:return e.prev=3,e.catch(1),e.abrupt("return",{overall:0,cleanliness:0,maintenance:0,accessibility:0,totalReviews:0});case 4:case"end":return e.stop()}},e,this,[[1,3]])})),function(t){return e.apply(this,arguments)})}]);var e,t,r,n,l,f,h,v}(),h=new f},662(e,t,r){r.d(t,{V:()=>v});var n=r(467),a=r(848),i=r(29),s=r(901),o=r(756),c=r(277);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){(0,n.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var h=function(){return(0,s.A)(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.A.api.baseUrl;(0,i.A)(this,e),this.baseUrl=t,this.defaultHeaders={"Content-Type":"application/json"},this.requestInterceptors=[],this.responseInterceptors=[]},[{key:"addRequestInterceptor",value:function(e){this.requestInterceptors.push(e)}},{key:"addResponseInterceptor",value:function(e){this.responseInterceptors.push(e)}},{key:"request",value:(r=(0,a.A)(o.mark(function e(t){var r,n,a,i,s,c,u,l,f,h,v,d,b,m,y,w,g=arguments;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=g.length>1&&void 0!==g[1]?g[1]:{},n=this.buildUrl(t),a=this.buildRequestOptions(r),i=a,s=p(this.requestInterceptors),e.prev=1,s.s();case 2:if((c=s.n()).done){e.next=5;break}return u=c.value,e.next=3,u(i);case 3:i=e.sent;case 4:e.next=2;break;case 5:e.next=7;break;case 6:e.prev=6,m=e.catch(1),s.e(m);case 7:return e.prev=7,s.f(),e.finish(7);case 8:return e.prev=8,e.next=9,this.makeRequest(n,i);case 9:return l=e.sent,e.next=10,this.handleResponse(l);case 10:f=e.sent,h=f,v=p(this.responseInterceptors),e.prev=11,v.s();case 12:if((d=v.n()).done){e.next=15;break}return b=d.value,e.next=13,b(h,l);case 13:h=e.sent;case 14:e.next=12;break;case 15:e.next=17;break;case 16:e.prev=16,y=e.catch(11),v.e(y);case 17:return e.prev=17,v.f(),e.finish(17);case 18:return e.abrupt("return",h);case 19:throw e.prev=19,w=e.catch(8),this.handleError(w);case 20:case"end":return e.stop()}},e,this,[[1,6,7,8],[8,19],[11,16,17,18]])})),function(e){return r.apply(this,arguments)})},{key:"buildUrl",value:function(e){var t=e.startsWith("/")?e.slice(1):e;return"".concat(this.baseUrl,"/api/").concat(t)}},{key:"buildRequestOptions",value:function(e){return l(l({method:"GET",headers:l({},this.defaultHeaders),timeout:c.A.api.timeout},e),{},{headers:l(l({},this.defaultHeaders),e.headers)})}},{key:"makeRequest",value:(t=(0,a.A)(o.mark(function e(t,r){var n,a,i,s,u,p=arguments;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>2&&void 0!==p[2]?p[2]:0,e.prev=1,a=new AbortController,i=setTimeout(function(){return a.abort()},r.timeout),e.next=2,fetch(t,l(l({},r),{},{signal:a.signal}));case 2:return s=e.sent,clearTimeout(i),e.abrupt("return",s);case 3:if(e.prev=3,"AbortError"!==(u=e.catch(1)).name){e.next=4;break}throw new Error("Request timeout");case 4:if(!(n<c.A.api.retries)){e.next=6;break}return e.next=5,this.delay(c.A.api.retryDelay*(n+1));case 5:return e.abrupt("return",this.makeRequest(t,r,n+1));case 6:throw u;case 7:case"end":return e.stop()}},e,this,[[1,3]])})),function(e,r){return t.apply(this,arguments)})},{key:"handleResponse",value:(e=(0,a.A)(o.mark(function e(t){var r,n,a;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.headers.get("content-type"))||!r.includes("application/json")){e.next=2;break}return e.next=1,t.json();case 1:n=e.sent,e.next=4;break;case 2:return e.next=3,t.text();case 3:n=e.sent;case 4:if(t.ok){e.next=5;break}throw(a=new Error(n.message||"HTTP ".concat(t.status))).status=t.status,a.data=n,a;case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})},{key:"handleError",value:function(e){if(e.status)switch(e.status){case 400:e.message="Bad request - please check your input";break;case 401:e.message="Authentication required";break;case 403:e.message="Access denied";break;case 404:e.message="Resource not found";break;case 429:e.message="Too many requests - please try again later";break;case 500:e.message="Server error - please try again later"}return e}},{key:"delay",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,l(l({},t),{},{method:"GET"}))}},{key:"post",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,l(l({},r),{},{method:"POST",body:JSON.stringify(t)}))}},{key:"put",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,l(l({},r),{},{method:"PUT",body:JSON.stringify(t)}))}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,l(l({},t),{},{method:"DELETE"}))}}]);var e,t,r}(),v=new h}}]);
//# sourceMappingURL=services.11eea597a3e767aa57bc.js.map