(()=>{var e,t={680(e,t,n){"use strict";var i=n(506),r=n(848),a=n(29),o=n(901),s=n(388),c=n(954);function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=(0,c.A)(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},l.apply(null,arguments)}var u=n(361),d=n(756),h=n(758),v=n(851),p=n(105),f=n(438),g=n(567),m=n(134),y=n(277);function w(e,t,n){return t=(0,c.A)(t),(0,s.A)(e,b()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}var k=function(e){function t(){var e;return(0,a.A)(this,t),(e=w(this,t,[{requiresAuth:!1,requiredRole:"admin"}])).map=null,e.markers=null,e.qrScanner=null,e.currentToiletId=null,e.allToilets=[],e.allReviews=[],e.currentView="dashboard",e.handleLogin=e.handleLogin.bind(e),e.handleRegister=e.handleRegister.bind(e),e.handleLogout=e.handleLogout.bind(e),e.showDashboard=e.showDashboard.bind(e),e.showReviews=e.showReviews.bind(e),e.showQRCodes=e.showQRCodes.bind(e),e.loadToilets=e.loadToilets.bind(e),e.addToilet=e.addToilet.bind(e),e.updateToilet=e.updateToilet.bind(e),e.deleteToilet=e.deleteToilet.bind(e),e.loadReviews=e.loadReviews.bind(e),e.loadQRCodes=e.loadQRCodes.bind(e),e.generateQRCode=e.generateQRCode.bind(e),e.downloadQR=e.downloadQR.bind(e),e.filterReviews=e.filterReviews.bind(e),e}return(0,u.A)(t,e),(0,o.A)(t,[{key:"init",value:(P=(0,r.A)(d.mark(function e(){var t,n;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("adminToken"),!(n=t)){e.next=2;break}return e.next=1,this.validateStoredToken();case 1:n=e.sent;case 2:if(!n){e.next=4;break}return e.next=3,this.showDashboard();case 3:e.next=5;break;case 4:this.showLoginForm();case 5:case 6:case"end":return e.stop()}},e,this)})),function(){return P.apply(this,arguments)})},{key:"validateStoredToken",value:(C=(0,r.A)(d.mark(function e(){var t;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,p.E.validateToken(localStorage.getItem("adminToken"));case 1:return t=e.sent,e.abrupt("return",t.valid);case 2:return e.prev=2,e.catch(0),localStorage.removeItem("adminToken"),localStorage.removeItem("token"),e.abrupt("return",!1);case 3:case"end":return e.stop()}},e,null,[[0,2]])})),function(){return C.apply(this,arguments)})},{key:"showLoginForm",value:function(){var e=(0,m.$)("#loginForm"),t=(0,m.$)("#adminDashboard");e&&(e.style.display="block"),t&&(t.style.display="none"),this.setupLoginForm()}},{key:"setupLoginForm",value:function(){var e=(0,m.$)("#adminLoginForm"),t=(0,m.$)("#adminRegisterForm");e&&e.addEventListener("submit",this.handleLogin),t&&t.addEventListener("submit",this.handleRegister)}},{key:"handleLogin",value:($=(0,r.A)(d.mark(function e(t){var n,i,r,a;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=(0,m.$)("#email").value.trim(),i=(0,m.$)("#password").value,n&&i){e.next=1;break}return this.showLoginError("Please enter both email and password"),e.abrupt("return");case 1:return v.Ay.setLoading("auth",!0),e.prev=2,e.next=3,p.E.login({email:n,password:i});case 3:if(!(r=e.sent).token){e.next=5;break}return p.E.setToken(r.token),v.Ay.setUser(!0,r.user,r.token),e.next=4,this.showDashboard();case 4:e.next=6;break;case 5:throw new Error("Invalid login response");case 6:e.next=8;break;case 7:e.prev=7,a=e.catch(2),this.showLoginError(a.message||"Login failed. Please try again.");case 8:return e.prev=8,v.Ay.setLoading("auth",!1),e.finish(8);case 9:case"end":return e.stop()}},e,this,[[2,7,8,9]])})),function(e){return $.apply(this,arguments)})},{key:"handleRegister",value:(O=(0,r.A)(d.mark(function e(t){var n,i,r,a;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=(0,m.$)("#registerEmail").value.trim(),i=(0,m.$)("#registerPassword").value,n&&i){e.next=1;break}return this.showRegisterError("Please enter both email and password"),e.abrupt("return");case 1:if(!(i.length<y.A.validation.minPasswordLength)){e.next=2;break}return this.showRegisterError("Password must be at least ".concat(y.A.validation.minPasswordLength," characters long")),e.abrupt("return");case 2:return v.Ay.setLoading("auth",!0),e.prev=3,e.next=4,p.E.register({email:n,password:i,role:"admin"});case 4:if(!(r=e.sent).token){e.next=6;break}return p.E.setToken(r.token),v.Ay.setUser(!0,r.user,r.token),e.next=5,this.showDashboard();case 5:e.next=7;break;case 6:throw new Error("Invalid registration response");case 7:e.next=9;break;case 8:e.prev=8,a=e.catch(3),this.showRegisterError(a.message||"Registration failed. Please try again.");case 9:return e.prev=9,v.Ay.setLoading("auth",!1),e.finish(9);case 10:case"end":return e.stop()}},e,this,[[3,8,9,10]])})),function(e){return O.apply(this,arguments)})},{key:"handleLogout",value:(D=(0,r.A)(d.mark(function e(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,p.E.logout();case 1:v.Ay.setUser(!1),this.showLoginForm(),e.next=3;break;case 2:e.prev=2,e.catch(0),localStorage.removeItem("adminToken"),localStorage.removeItem("token"),v.Ay.setUser(!1),this.showLoginForm();case 3:case"end":return e.stop()}},e,this,[[0,2]])})),function(){return D.apply(this,arguments)})},{key:"showLoginError",value:function(e){var t=(0,m.$)("#loginError");t&&(t.textContent=e,t.style.display="block")}},{key:"showRegisterError",value:function(e){var t=(0,m.$)("#registerError");t&&(t.textContent=e,t.style.display="block")}},{key:"showDashboard",value:(E=(0,r.A)(d.mark(function e(){var t,n,i;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,m.$)("#loginForm"),n=(0,m.$)("#adminDashboard"),i=(0,m.$)("#logoutBtn"),t&&(t.style.display="none"),n&&(n.style.display="block"),i&&(i.style.display="inline-block"),this.currentView="dashboard",this.updateNavigation(),e.next=1,this.initializeDashboard();case 1:case"end":return e.stop()}},e,this)})),function(){return E.apply(this,arguments)})},{key:"initializeDashboard",value:(S=(0,r.A)(d.mark(function e(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.initializeMap();case 1:return e.next=2,Promise.all([this.loadToilets(),this.loadDashboardStats()]);case 2:this.setupDashboardEventListeners();case 3:case"end":return e.stop()}},e,this)})),function(){return S.apply(this,arguments)})},{key:"initializeMap",value:(x=(0,r.A)(d.mark(function e(){var t,n=this;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,m.$)("#map")){e.next=1;break}return e.abrupt("return");case 1:try{this.map=L.map(t,{center:y.A.map.defaultCenter,zoom:y.A.map.defaultZoom,minZoom:y.A.map.minZoom,maxZoom:y.A.map.maxZoom}),this.markers=L.markerClusterGroup({maxClusterRadius:y.A.map.maxClusterRadius}),L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:"©OpenStreetMap, ©CartoDB"}).addTo(this.map),this.map.addLayer(this.markers),this.map.on("click",function(e){var t=e.latlng,i=t.lat,r=t.lng;n.handleMapClick(i,r)})}catch(e){}case 2:case"end":return e.stop()}},e,this)})),function(){return x.apply(this,arguments)})},{key:"handleMapClick",value:function(e,t){var n=(0,m.$)("#latitude"),i=(0,m.$)("#longitude");n&&(n.value=e),i&&(i.value=t),this.currentMarker?this.currentMarker.setLatLng([e,t]):this.currentMarker=L.marker([e,t]).addTo(this.map)}},{key:"loadToilets",value:(R=(0,r.A)(d.mark(function e(){var t;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v.Ay.setLoading("toilets",!0),e.prev=1,e.next=2,f.Z.getMapData({showPublic:!0,showPrivate:!0,limit:1e3});case 2:t=e.sent,this.allToilets=t.data||[],this.updateToiletsList(),this.updateMapWithToilets(),e.next=4;break;case 3:e.prev=3,e.catch(1),v.Ay.addNotification({type:"error",title:"Load Error",message:"Failed to load toilets data"});case 4:return e.prev=4,v.Ay.setLoading("toilets",!1),e.finish(4);case 5:case"end":return e.stop()}},e,this,[[1,3,4,5]])})),function(){return R.apply(this,arguments)})},{key:"updateToiletsList",value:function(){var e=(0,m.$)("#toiletList");if(e){var t="<h2>Registered Toilets</h2>";0===this.allToilets.length?t+="<p>No toilets registered yet.</p>":this.allToilets.forEach(function(e){e.type;t+='\n                    <div class="toilet-item">\n                        <div class="toilet-info">\n                            <h3>'.concat(e.name,"</h3>\n                            <p>").concat(e.location,"</p>\n                            <p>Rating: ").concat(e.averageRating?e.averageRating.toFixed(1):"No ratings",' ⭐</p>\n                        </div>\n                        <div class="toilet-actions">\n                            <button class="btn edit-btn" onclick="adminPage.editToilet(\'').concat(e.id,'\')">Edit</button>\n                            <button class="btn delete-btn" onclick="adminPage.deleteToilet(\'').concat(e.id,"')\">Delete</button>\n                        </div>\n                    </div>\n                ")}),e.innerHTML=t}}},{key:"updateMapWithToilets",value:function(){var e=this;this.markers&&this.allToilets&&(this.markers.clearLayers(),this.allToilets.forEach(function(t){var n,i;if(null!==(n=t.coordinates)&&void 0!==n&&n.latitude&&null!==(i=t.coordinates)&&void 0!==i&&i.longitude){var r=L.marker([t.coordinates.latitude,t.coordinates.longitude]),a='\n                    <div class="toilet-popup">\n                        <h3>'.concat(t.name,"</h3>\n                        <p>").concat(t.location,"</p>\n                        <p>Type: ").concat(t.type,"</p>\n                        <p>Rating: ").concat(t.averageRating||"No ratings","</p>\n                        <button onclick=\"adminPage.editToilet('").concat(t.id,"')\">Edit</button>\n                        <button onclick=\"adminPage.deleteToilet('").concat(t.id,"')\">Delete</button>\n                    </div>\n                ");r.bindPopup(a),e.markers.addLayer(r)}}))}},{key:"addToilet",value:(T=(0,r.A)(d.mark(function e(t){var n,i;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),(n={name:(0,m.$)("#toiletName").value.trim(),location:(0,m.$)("#toiletLocation").value.trim(),description:(0,m.$)("#toiletDescription").value.trim(),coordinates:{latitude:parseFloat((0,m.$)("#latitude").value),longitude:parseFloat((0,m.$)("#longitude").value)},facilities:Array.from(document.querySelectorAll('input[name="facilities"]:checked')).map(function(e){return e.value})}).name&&n.location){e.next=1;break}return this.showToiletError("Name and location are required"),e.abrupt("return");case 1:if(!isNaN(n.coordinates.latitude)&&!isNaN(n.coordinates.longitude)){e.next=2;break}return this.showToiletError("Please select a location on the map"),e.abrupt("return");case 2:return v.Ay.setLoading("toilet",!0),e.prev=3,e.next=4,f.Z.addPrivateToilet(n);case 4:return t.target.reset(),this.currentMarker&&(this.map.removeLayer(this.currentMarker),this.currentMarker=null),e.next=5,this.loadToilets();case 5:v.Ay.addNotification({type:"success",title:"Success",message:"Toilet added successfully"}),e.next=7;break;case 6:e.prev=6,i=e.catch(3),this.showToiletError(i.message||"Failed to add toilet");case 7:return e.prev=7,v.Ay.setLoading("toilet",!1),e.finish(7);case 8:case"end":return e.stop()}},e,this,[[3,6,7,8]])})),function(e){return T.apply(this,arguments)})},{key:"editToilet",value:function(e){var t=this.allToilets.find(function(t){return t.id===e});t&&((0,m.$)("#toiletName").value=t.name,(0,m.$)("#toiletLocation").value=t.location,(0,m.$)("#toiletDescription").value=t.description||"",(0,m.$)("#latitude").value=t.coordinates.latitude,(0,m.$)("#longitude").value=t.coordinates.longitude,document.querySelectorAll('input[name="facilities"]').forEach(function(e){var n;e.checked=(null===(n=t.facilities)||void 0===n?void 0:n.includes(e.value))||!1}),this.currentMarker?this.currentMarker.setLatLng([t.coordinates.latitude,t.coordinates.longitude]):this.currentMarker=L.marker([t.coordinates.latitude,t.coordinates.longitude]).addTo(this.map),this.currentToiletId=e)}},{key:"deleteToilet",value:(A=(0,r.A)(d.mark(function e(t){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("Are you sure you want to delete this toilet?")){e.next=1;break}return e.abrupt("return");case 1:return v.Ay.setLoading("toilet",!0),e.prev=2,e.next=3,f.Z.deleteToilet(t);case 3:return e.next=4,this.loadToilets();case 4:v.Ay.addNotification({type:"success",title:"Success",message:"Toilet deleted successfully"}),e.next=6;break;case 5:e.prev=5,e.catch(2),v.Ay.addNotification({type:"error",title:"Delete Error",message:"Failed to delete toilet"});case 6:return e.prev=6,v.Ay.setLoading("toilet",!1),e.finish(6);case 7:case"end":return e.stop()}},e,this,[[2,5,6,7]])})),function(e){return A.apply(this,arguments)})},{key:"showReviews",value:(k=(0,r.A)(d.mark(function e(){var t,n,i;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentView="reviews",this.updateNavigation(),t=(0,m.$)("#adminDashboard"),n=(0,m.$)("#reviewsSection"),i=(0,m.$)("#qrCodesSection"),t&&(t.style.display="none"),i&&(i.style.display="none"),n&&(n.style.display="block"),e.next=1,this.loadReviews();case 1:case"end":return e.stop()}},e,this)})),function(){return k.apply(this,arguments)})},{key:"loadReviews",value:(b=(0,r.A)(d.mark(function e(){var t;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v.Ay.setLoading("reviews",!0),e.prev=1,e.next=2,g.W.getAllReviews({limit:1e3});case 2:t=e.sent,this.allReviews=t||[],this.updateReviewsDisplay(),e.next=4;break;case 3:e.prev=3,e.catch(1),v.Ay.addNotification({type:"error",title:"Load Error",message:"Failed to load reviews data"});case 4:return e.prev=4,v.Ay.setLoading("reviews",!1),e.finish(4);case 5:case"end":return e.stop()}},e,this,[[1,3,4,5]])})),function(){return b.apply(this,arguments)})},{key:"updateReviewsDisplay",value:function(){var e=(0,m.$)(".review-list");e&&(0!==this.allReviews.length?e.innerHTML=this.allReviews.map(function(e){return'\n            <div class="review-card">\n                <div class="review-header">\n                    <div class="review-toilet-name">'.concat(e.toiletName||"Unknown Toilet",'</div>\n                    <div class="review-rating">\n                        ').concat("★".repeat(e.rating)).concat("☆".repeat(5-e.rating),'\n                    </div>\n                </div>\n                <div class="review-comment">').concat(e.comment||"No comment",'</div>\n                <div class="review-meta">\n                    <div>Posted: ').concat(new Date(e.createdAt).toLocaleString(),"</div>\n                    <div>").concat(e.rating,"/5 stars</div>\n                </div>\n            </div>\n        ")}).join(""):e.innerHTML='<div class="no-reviews">No reviews found.</div>')}},{key:"showQRCodes",value:(h=(0,r.A)(d.mark(function e(){var t,n,i;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentView="qrcodes",this.updateNavigation(),t=(0,m.$)("#adminDashboard"),n=(0,m.$)("#reviewsSection"),i=(0,m.$)("#qrCodesSection"),t&&(t.style.display="none"),n&&(n.style.display="none"),i&&(i.style.display="block"),e.next=1,this.loadQRCodes();case 1:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"loadQRCodes",value:(s=(0,r.A)(d.mark(function e(){var t,n,i;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,m.$)(".qr-grid")){e.next=1;break}return e.abrupt("return");case 1:return t.innerHTML='<div class="loading">Loading QR Codes...</div>',e.prev=2,n=this.allToilets.map(function(){var e=(0,r.A)(d.mark(function e(t){var n;return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,f.Z.generateQRCode(t.id);case 1:return n=e.sent,e.abrupt("return",{toilet:t,qrData:n});case 2:return e.prev=2,e.catch(0),e.abrupt("return",{toilet:t,error:!0});case 3:case"end":return e.stop()}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:i=e.sent,t.innerHTML="",i.forEach(function(e){var n=e.toilet,i=e.qrData,r=e.error,a=document.createElement("div");a.className="qr-card",a.innerHTML=r?"\n                        <h3>".concat(n.name,"</h3>\n                        <p>").concat(n.location,'</p>\n                        <div style="color: #dc3545; text-align: center; padding: 20px;">\n                            Error generating QR code\n                        </div>\n                    '):"\n                        <h3>".concat(n.name,"</h3>\n                        <p>").concat(n.location,'</p>\n                        <img src="').concat(i.qrCode,'" alt="QR Code for ').concat(n.name,'">\n                        <button class="download-btn" onclick="adminPage.downloadQR(\'').concat(i.qrCode,"', '").concat(n.name,"')\">\n                            Download QR Code\n                        </button>\n                    "),t.appendChild(a)}),e.next=5;break;case 4:e.prev=4,e.catch(2),t.innerHTML='<div class="error-message">Error loading QR codes</div>';case 5:case"end":return e.stop()}},e,this,[[2,4]])})),function(){return s.apply(this,arguments)})},{key:"downloadQR",value:function(e,t){fetch(e).then(function(e){return e.blob()}).then(function(e){var n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="".concat(t.replace(/[^a-zA-Z0-9]/g,"_"),"_QR.png"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}).catch(function(e){v.Ay.addNotification({type:"error",title:"Download Error",message:"Failed to download QR code"})})}},{key:"updateNavigation",value:function(){var e=this;$$("[data-nav-view]").forEach(function(t){var n=t.getAttribute("data-nav-view");t.classList.toggle("active",n===e.currentView)})}},{key:"setupDashboardEventListeners",value:function(){var e=this,t=(0,m.$)("#addToiletForm");t&&t.addEventListener("submit",this.addToilet);var n=(0,m.$)("#showDashboardBtn"),i=(0,m.$)("#showReviewsBtn"),r=(0,m.$)("#showQRCodesBtn"),a=(0,m.$)("#logoutBtn");n&&n.addEventListener("click",function(){return e.showDashboard()}),i&&i.addEventListener("click",function(){return e.showReviews()}),r&&r.addEventListener("click",function(){return e.showQRCodes()}),a&&a.addEventListener("click",this.handleLogout);var o=(0,m.$)("#toiletFilter"),s=(0,m.$)("#ratingFilter");o&&o.addEventListener("change",this.filterReviews),s&&s.addEventListener("change",this.filterReviews)}},{key:"filterReviews",value:function(){var e,t,n=null===(e=(0,m.$)("#toiletFilter"))||void 0===e?void 0:e.value,r=null===(t=(0,m.$)("#ratingFilter"))||void 0===t?void 0:t.value,a=(0,i.A)(this.allReviews);n&&(a=a.filter(function(e){return e.toiletId===n})),r&&(a=a.filter(function(e){return e.rating===parseInt(r)})),this.displayFilteredReviews(a)}},{key:"displayFilteredReviews",value:function(e){var t=(0,m.$)(".review-list");t&&(0!==e.length?t.innerHTML=e.map(function(e){return'\n            <div class="review-card">\n                <div class="review-header">\n                    <div class="review-toilet-name">'.concat(e.toiletName||"Unknown Toilet",'</div>\n                    <div class="review-rating">\n                        ').concat("★".repeat(e.rating)).concat("☆".repeat(5-e.rating),'\n                    </div>\n                </div>\n                <div class="review-comment">').concat(e.comment||"No comment",'</div>\n                <div class="review-meta">\n                    <div>Posted: ').concat(new Date(e.createdAt).toLocaleString(),"</div>\n                    <div>").concat(e.rating,"/5 stars</div>\n                </div>\n            </div>\n        ")}).join(""):t.innerHTML='<div class="no-reviews">No reviews match the current filters.</div>')}},{key:"loadDashboardStats",value:(n=(0,r.A)(d.mark(function e(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,f.Z.getStatistics();case 1:e.sent,e.next=3;break;case 2:e.prev=2,e.catch(0);case 3:case"end":return e.stop()}},e,null,[[0,2]])})),function(){return n.apply(this,arguments)})},{key:"showToiletError",value:function(e){var t=(0,m.$)("#addToiletError");t&&(t.textContent=e,t.style.display="block")}},{key:"getPageContainer",value:function(){return document.body}},{key:"destroy",value:function(){var e,n,i,r,a;this.map&&(this.map.remove(),this.map=null),this.markers&&(this.markers.clearLayers(),this.markers=null),this.currentMarker&&(this.map.removeLayer(this.currentMarker),this.currentMarker=null),(e=t,n="destroy",i=this,r=3,a=l((0,c.A)(1&r?e.prototype:e),n,i),2&r&&"function"==typeof a?function(e){return a.apply(i,e)}:a)([])}}]);var n,s,h,b,k,A,T,R,x,S,E,D,O,$,C,P}(h.v);window.adminPage=new k},718(e,t,n){"use strict";n.d(t,{Sn:()=>i});var i={TOILETS:{MAP:"toilet/map",STATS:"toilet/stats",ADD_PRIVATE:"toilet/add-private",SYNC_PUBLIC:"toilet/sync-public",BY_ID:function(e){return"toilet/".concat(e)},QR_CODE:function(e){return"toilet/".concat(e,"/qr")}},REVIEWS:{SUBMIT:"review/submit",ALL:"review/all",BY_TOILET:function(e){return"review/toilet/".concat(e)},BY_ID:function(e){return"reviews/".concat(e)}},AUTH:{LOGIN:"auth/login",REGISTER:"auth/register",LOGOUT:"auth/logout",ME:"auth/me"},ADMIN:{LOGIN:"admin/login",DASHBOARD:"admin/dashboard",STATS:"admin/stats"},SYSTEM:{SLO_METRICS:"slo/metrics",CACHE_STATS:"cache/stats",CACHE_INVALIDATE:"cache/invalidate"}}},756(e,t,n){var i=n(633)();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},851(e,t,n){"use strict";n.d(t,{Ay:()=>h});var i=n(506),r=n(467),a=n(284),o=n(29),s=n(901),c=n(277);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var d=function(){return(0,s.A)(function e(){(0,o.A)(this,e),this.state={loading:{global:!1,toilets:!1,reviews:!1,auth:!1},ui:{activeModal:null,notifications:[],sidebarOpen:!1,theme:"light"},user:{isAuthenticated:!1,data:null,token:null},data:{toilets:[],reviews:[],stats:null},settings:{mapFilters:{showPublic:!0,showPrivate:!0},qrScanner:{active:!1,lastScan:null}}},this.observers=new Map,this.history=[],this.maxHistorySize=10,this.subscribe=this.subscribe.bind(this),this.unsubscribe=this.unsubscribe.bind(this),this.notify=this.notify.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.resetState=this.resetState.bind(this)},[{key:"subscribe",value:function(e,t){var n=this;return this.observers.has(e)||this.observers.set(e,new Set),this.observers.get(e).add(t),function(){return n.unsubscribe(e,t)}}},{key:"unsubscribe",value:function(e,t){this.observers.has(e)&&this.observers.get(e).delete(t)}},{key:"notify",value:function(e,t){var n=this;this.observers.has(e)&&this.observers.get(e).forEach(function(i){try{i(e,t,n.getState())}catch(e){}})}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}},{key:"setState",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getState();if("function"==typeof e)t=e(i);else{if("object"!==(0,a.A)(e))return;t=this.deepMerge(i,e)}this.validateState(t)&&(this.state=t,this.addToHistory(i,t,n),!0!==n.silent&&this.notify("state:changed",{prevState:i,newState:t,changes:this.getStateChanges(i,t)}))}},{key:"deepMerge",value:function(e,t){var n=this,i=u({},e);return Object.keys(t).forEach(function(r){t[r]&&"object"===(0,a.A)(t[r])&&!Array.isArray(t[r])?i[r]=n.deepMerge(e[r]||{},t[r]):i[r]=t[r]}),i}},{key:"validateState",value:function(e){return["loading","ui","user","data","settings"].every(function(t){return t in e})}},{key:"getStateChanges",value:function(e,t){var n={},i=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object.keys(t).forEach(function(o){var s=r?"".concat(r,".").concat(o):o;o in e?e[o]!==t[o]&&("object"===(0,a.A)(e[o])&&"object"===(0,a.A)(t[o])?i(e[o],t[o],s):n[s]={from:e[o],to:t[o]}):n[s]={from:void 0,to:t[o]}})};return i(e,t),n}},{key:"addToHistory",value:function(e,t,n){this.history.push({timestamp:new Date,prevState:e,newState:t,description:n.description||"State change",changes:this.getStateChanges(e,t)}),this.history.length>this.maxHistorySize&&this.history.shift()}},{key:"resetState",value:function(){this.setState({loading:{global:!1,toilets:!1,reviews:!1,auth:!1},ui:{activeModal:null,notifications:[],sidebarOpen:!1,theme:"light"},user:{isAuthenticated:!1,data:null,token:null},data:{toilets:[],reviews:[],stats:null},settings:{mapFilters:{showPublic:!0,showPrivate:!0},qrScanner:{active:!1,lastScan:null}}},{description:"State reset"})}},{key:"getHistory",value:function(){return(0,i.A)(this.history)}},{key:"setLoading",value:function(e,t){this.setState(function(n){return u(u({},n),{},{loading:u(u({},n.loading),{},(0,r.A)({},e,t))})},{description:"Loading ".concat(e,": ").concat(t)})}},{key:"setUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setState(function(i){return u(u({},i),{},{user:{isAuthenticated:e,data:t,token:n}})},{description:"User authentication: ".concat(e)})}},{key:"addNotification",value:function(e){var t=this,n=Date.now().toString(),r=u(u({},e),{},{id:n});return this.setState(function(e){return u(u({},e),{},{ui:u(u({},e.ui),{},{notifications:[].concat((0,i.A)(e.ui.notifications),[r])})})},{description:"Notification added"}),0!==e.duration&&setTimeout(function(){t.removeNotification(n)},e.duration||c.A.ui.toastDuration),n}},{key:"removeNotification",value:function(e){this.setState(function(t){return u(u({},t),{},{ui:u(u({},t.ui),{},{notifications:t.ui.notifications.filter(function(t){return t.id!==e})})})},{description:"Notification removed"})}},{key:"setToilets",value:function(e){this.setState(function(t){return u(u({},t),{},{data:u(u({},t.data),{},{toilets:e||[]})})},{description:"Toilets updated"})}},{key:"setReviews",value:function(e){this.setState(function(t){return u(u({},t),{},{data:u(u({},t.data),{},{reviews:e||[]})})},{description:"Reviews updated"})}}])}();const h=new d}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,n,r,a)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,r,a]=e[u],s=!0,c=0;c<n.length;c++)(!1&a||o>=a)&&Object.keys(i.O).every(e=>i.O[e](n[c]))?n.splice(c--,1):(s=!1,a<o&&(o=a));if(s){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,r,a]},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={419:0,884:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[o,s,c]=n,l=0;if(o.some(t=>0!==e[t])){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(c)var u=c(i)}for(t&&t(n);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},n=self.webpackChunktoilet_review_system_frontend=self.webpackChunktoilet_review_system_frontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=i.O(void 0,[671,866,263],()=>i(680));r=i.O(r)})();
//# sourceMappingURL=admin.57bac18b2140d95d6aac.js.map